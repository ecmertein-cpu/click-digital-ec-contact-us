/**
 * Sends an email notification when a new row is added via SheetDB API.
 */
function sendEmailNotification(e) {
  var recipientEmail = "emre@clickdigitalec.com";
  var subject = "New Lead Captured! ðŸš€";
  
  var ss = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = ss.getActiveSheet();
  
  // Get the last row that has data
  var lastRow = sheet.getLastRow();
  
  // If the sheet is empty, stop the function
  if (lastRow < 2) return;

  // Get the values of the last row (Name, Email, Phone, Message)
  var range = sheet.getRange(lastRow, 1, 1, 4); 
  var values = range.getValues()[0];
  
  var name = values[0] || "N/A";
  var email = values[1] || "N/A";
  var phone = values[2] || "N/A";
  var message = values[3] || "N/A";

  // Create the professional email body
  var emailBody = "Hello Emre,\n\n" +
                  "A new form has been submitted on your website:\n\n" +
                  "----------------------------------\n" +
                  "ðŸ‘¤ Name: " + name + "\n" +
                  "ðŸ“§ Email: " + email + "\n" +
                  "ðŸ“ž Phone: " + phone + "\n" +
                  "ðŸ’¬ Message: " + message + "\n" +
                  "----------------------------------\n\n" +
                  "This data has been automatically saved to your Google Sheet.\n\n" +
                  "Best Regards,\n" +
                  "Click Digital Automation System";

  // Send the email
  try {
    MailApp.sendEmail(recipientEmail, subject, emailBody);
    Logger.log("Email sent successfully to " + recipientEmail);
  } catch (err) {
    Logger.log("Error sending email: " + err.toString());
  }
}
